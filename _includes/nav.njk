{% macro section(collection, title) %}
  <details {{ "open" if collection in page.url }}>
    <summary style="margin-bottom: 0.5rem">
      <h2 class="nav-heading">{{ title }}</h2>
    </summary>
      <ul>
        {% if caller %}
          {{ caller() }}
        {% else %}
          {% for page in collections[collection] %}
            {% if page.data.nav !== false %}
              {{ link(page.url, page.data.title) }}
            {% endif %}
          {% endfor %}
        {% endif %}
      </ul>
  </details>
{% endmacro %}

{% macro link(url, label) %}
  <li>
    <a
      class="nav-link"
      href="{{ url }}"
      {% if page.url === url %}
        aria-current="page"
      {% elif url in page.url %}
        aria-current="true"
      {% endif %}
    >
      {{ label }}
    </a>
  </li>
{% endmacro %}

<nav id="globalNav" class="global-nav" style="--flow-space: 1.5rem">

    <a href="/" aria-label="Home">
      <img src="/assets/images/logo.svg" width="140" alt="">
    </a>

    <button id="toggle-nav" class="toggle-nav">
      <svg viewBox="0 0 20 20" width="32" height="32" fill="currentColor">
        <path
          id="open"
          fill-rule="evenodd"
          d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h6a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
          clip-rule="evenodd"
        />
        <path
          id="closed"
          fill-rule="evenodd"
          d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"
        />
      </svg>
    </button>

  <div id="nav-content" class="nav-content flow">
    {{ section("precourse", "Precourse") }}

    {{ section("handbook", "Student Handbook") }}

    {% call section("curriculum", "Curriculum") -%}
      {{ link("/curriculum/teamwork-and-toolkit/", "Teamwork & Toolkit") }}
      {{ link("/curriculum/http/", "HTTP") }}
      {{ link("/curriculum/testing/", "Testing") }}
      {{ link("/curriculum/node/", "Node") }}
      {{ link("/curriculum/databases/", "Databases") }}
      {{ link("/curriculum/authentication/", "Authentication") }}
      {{ link("/curriculum/rest-apis/", "REST") }}
      {{ link("/curriculum/single-page-app/", "SPA") }}
      {{ link("/curriculum/react/", "React") }}
    {%- endcall %}

    {{ section("projects", "Projects") }}
  </div>

</nav>

